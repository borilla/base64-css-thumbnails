var convert = require('../index');

var chai = require('chai');
var chaiSubset = require('chai-subset');
var expect = chai.expect;

var FIXTURES_DIR = __dirname + '/fixtures/';

chai.use(chaiSubset);

describe('convert', function () {
	// eslint-disable-next-line no-unused-vars
	var options, results, error;

	before(function () {
		options = {
			pattern: '**/*.{jpeg,jpg,png}',
			cwd: FIXTURES_DIR,
			width: 16,
			height: 16
		};
	});

	beforeEach(function (done) {
		results = error = undefined;
		convert(options)
			.then(function (r) {
				results = r;
				done();
			})
			.catch(function (e) {
				error = e;
				done();
			});
	});

	it('should be a function', function () {
		expect(convert).to.be.a('function');
	});

	it('should return an info array', function () {
		expect(results.info).to.be.an('array');
	});

	it('should return the expected number of results', function () {
		expect(results.info.length).to.equal(3);
	});

	it('should return file paths relative to root (cwd) directory', function () {
		expect(results.info).to.containSubset([
			{ file: 'images/acquisition-tile-00-300.jpg' },
			{ file: 'images/battleship-wild-targets-tile-15-300.jpg' },
			{ file: 'images/secrets-of-the-phoenix-tile-10-300.png' }
		]);
	});

	it('should return base64 code for image thumbnails', function () {
		expect(results.info).to.containSubset([
			{ base64: 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAoAEAMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APwZ1nxX4y/aS1jQPhH4e1PWpdOk1fT/ABHr1npAmvBHpvhqLU9RtZri3FrqVvDZR+IH0a5vLmTTrxhDDJBDbyTXCrX6L4s8RYfCZdgHXq0qVGWLkpOpKUYTqRw9WMac+V+8pUp1moSuueEJaSjE+e+jzwDn3Emf5vhsgyzG5rmlLK/aww+CpRrVqWFeLw0a2Igqk6cKfJiHhacp838OtONmpu3ReLPihc/BzxZrvgaR/G+ny6xd23xA1Kz8cadp+j3Nr4i8W6fZv4mtPD1ppUUNk3hGLWbO7fRJnSW/JlurfUru4urc7PP8G88pyy3N40KmGlhVjKPsI4WVR0Ye5UUlarGMlW9k8PCorRjywpJRjZnd9JDgTOsj4jySjxDluOy3OamW169elmEKFOvPC1cXJ4eovq061KWHliI450WqlRtOd6s1Znwb+z1dXSftJfDZkubhGXV7l1ZZpFZXTwn4rdHBDAhkdVZWHKsAwIIBr5XxchCtw7iYVYRqxvSfLUipx0xFG2kk1p6Hn8FV6+FjmM8NWq4ecsO4SlQqToylDmU+SUqbi3HnjGfK3bmjGVrpM4742ahqFz+0B8Rpbm+vLiWTWnZ5Z7maWR2+z2i7neR2ZjtVVySThVHQCjwohClw9h40oRpRtflpxUFrUm3pFJatu/q+4cW16+KpZXPFVquJnHCzhGdepOtKMfrVf3VKo5NR1eidtdj/AP/Z' },
			{ base64: 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAA4AEAMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APzO/wCCbvgj9hTU/wBmD4Br8T/gvaeL/ifaeEPE83jfRYf2af2e/idd+ONTuPih8Tdd8PeNpvH3xOvYvEfmReFPEXg/wZfeE5dS0fTLTSfANlqOn6NqH2/UNQv/ANHyfhzFYrA03hcvyfHzeEo5hW+s5zistxWHw+KjiYUIypf2Ni8PWdeeVZjOlGlip4uNOEqn1b2cafP+Y5jxXhIZhjMPXzDPsuWDxdTBSq4LhbL88wNSdOphVVrTxNTi7JsXh4YdZpl1GbnlrwcsTUp4d42nUqz9lF/wUd+GP7HHgv8AZQ+P174T+B8/h/4h6jovgnRfAIg/Zu/ZZ+Gdr4E1mPx54M8X6p4nfxl8MoovH/2u98F2l94an0tbmSwnh8WTR3EDw2pEBieHcfisix+axyXKcuw+XYZ4yvKlneLxmNlB1MsoxpwweLyXKpR5JZzhKtSolOEPZYnDTlHEUuWXo4fO8uw+ZYDB0+I83zitmGMpYCnDFcH4TIsLRqOlm2IlVljcHxbxJRq88ckxtKnRcqdWSqYbEqLoVWqf4xfs4f8ABRHXv2d/BXhbw3pfgXS/Etx4atr6zt5NWnuIIo/tWpXuoG+s7uxuYL+zv2S+exklhZP9DEsOWW5kA8zLOMauW5fLLngaeKo1KeChPmxGIw8rYJZ0qcefDzhJwms6rOcJNrmo0WrNNm2M4OliM3lm2HzOpgqrqYyfLHDYbFU5rGwyeNSNShjKVWhP2cslw86LcHyzk5WUowa3P2pf+Cm3jP8Aah+HJ8A674A0bw5ClnBYQ3thrOu6jKtrE1ozRzNqd/Ob55F06xX7XqK3uox/ZlWG9jilnjlutxtiq2Ax+DeEgp5lgK+CxVb28nF/WK3D9aVajh1TVHCpSyBOOEwioYNTx2JrKiq06k6rwfBscFiMNOGY1JYXDZrg83jhfq1GLnicDh+I8LQdSum61WSo8R14Sq1ZVKs4YXDQnOUKdKND/9k=' },
			{ base64: 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAcAEAMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/ANL4I+Mb3VfEfinTPCEOtWvwx8G+HNO1/wAI+G9WuxdPpfhvxNZ6TbWmg/ar7X9VuNPtNC17wx4x1Dw1YWqamkWl+J1i1e+l1G9mfQfis98cocNeB/CNbLMdm3Djx+cc08dluEj9dU8v4izTD46mlh8ypSnHNaeeUsNXnUxKVSeBwtfEUnHC0ovXiHwJyTiTiLJOBsDgcgxvEWDw+Pw2Y4nH4WdTCTx2IlXx2RQrYjGYepKFKvRzHCxx2LwuFxk8NTwkYYXC0nTlTxfrt78SPEhvPiL4Zv8AT4ovCVt8Ivit498QWsE0M13418PeG7/wIbPw3caNqZ1nw3pd/ptvqQ1CS/Md2ttaT3h0u4vtektzY/JZ/wCJ2N4k4czHOMFnGfVMs/stfUMHjMwxuKxFfMq+YUcBVxuKq5lWxbwUsFUyzFVsCsDVcZ4ati6KjgqldOv+f+Gng5Xp8fZNHFYbh/A0MjzbNclzStl+DoYermVLl+v0cM8JgsNQofVnRnHAyq1K9WrWqxWMr0oOjh4U/wD/2Q==' }
		]);
	});

	it('should return expected css', function () {
		expect(results.css).to.equal(
			'img[src*="images/acquisition-tile-00-300.jpg"] { background-image: url(data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAoAEAMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APwZ1nxX4y/aS1jQPhH4e1PWpdOk1fT/ABHr1npAmvBHpvhqLU9RtZri3FrqVvDZR+IH0a5vLmTTrxhDDJBDbyTXCrX6L4s8RYfCZdgHXq0qVGWLkpOpKUYTqRw9WMac+V+8pUp1moSuueEJaSjE+e+jzwDn3Emf5vhsgyzG5rmlLK/aww+CpRrVqWFeLw0a2Igqk6cKfJiHhacp838OtONmpu3ReLPihc/BzxZrvgaR/G+ny6xd23xA1Kz8cadp+j3Nr4i8W6fZv4mtPD1ppUUNk3hGLWbO7fRJnSW/JlurfUru4urc7PP8G88pyy3N40KmGlhVjKPsI4WVR0Ye5UUlarGMlW9k8PCorRjywpJRjZnd9JDgTOsj4jySjxDluOy3OamW169elmEKFOvPC1cXJ4eovq061KWHliI450WqlRtOd6s1Znwb+z1dXSftJfDZkubhGXV7l1ZZpFZXTwn4rdHBDAhkdVZWHKsAwIIBr5XxchCtw7iYVYRqxvSfLUipx0xFG2kk1p6Hn8FV6+FjmM8NWq4ecsO4SlQqToylDmU+SUqbi3HnjGfK3bmjGVrpM4742ahqFz+0B8Rpbm+vLiWTWnZ5Z7maWR2+z2i7neR2ZjtVVySThVHQCjwohClw9h40oRpRtflpxUFrUm3pFJatu/q+4cW16+KpZXPFVquJnHCzhGdepOtKMfrVf3VKo5NR1eidtdj/AP/Z); background-size: cover; }\n' +
			'img[src*="images/battleship-wild-targets-tile-15-300.jpg"] { background-image: url(data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAA4AEAMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/APzO/wCCbvgj9hTU/wBmD4Br8T/gvaeL/ifaeEPE83jfRYf2af2e/idd+ONTuPih8Tdd8PeNpvH3xOvYvEfmReFPEXg/wZfeE5dS0fTLTSfANlqOn6NqH2/UNQv/ANHyfhzFYrA03hcvyfHzeEo5hW+s5zistxWHw+KjiYUIypf2Ni8PWdeeVZjOlGlip4uNOEqn1b2cafP+Y5jxXhIZhjMPXzDPsuWDxdTBSq4LhbL88wNSdOphVVrTxNTi7JsXh4YdZpl1GbnlrwcsTUp4d42nUqz9lF/wUd+GP7HHgv8AZQ+P174T+B8/h/4h6jovgnRfAIg/Zu/ZZ+Gdr4E1mPx54M8X6p4nfxl8MoovH/2u98F2l94an0tbmSwnh8WTR3EDw2pEBieHcfisix+axyXKcuw+XYZ4yvKlneLxmNlB1MsoxpwweLyXKpR5JZzhKtSolOEPZYnDTlHEUuWXo4fO8uw+ZYDB0+I83zitmGMpYCnDFcH4TIsLRqOlm2IlVljcHxbxJRq88ckxtKnRcqdWSqYbEqLoVWqf4xfs4f8ABRHXv2d/BXhbw3pfgXS/Etx4atr6zt5NWnuIIo/tWpXuoG+s7uxuYL+zv2S+exklhZP9DEsOWW5kA8zLOMauW5fLLngaeKo1KeChPmxGIw8rYJZ0qcefDzhJwms6rOcJNrmo0WrNNm2M4OliM3lm2HzOpgqrqYyfLHDYbFU5rGwyeNSNShjKVWhP2cslw86LcHyzk5WUowa3P2pf+Cm3jP8Aah+HJ8A674A0bw5ClnBYQ3thrOu6jKtrE1ozRzNqd/Ob55F06xX7XqK3uox/ZlWG9jilnjlutxtiq2Ax+DeEgp5lgK+CxVb28nF/WK3D9aVajh1TVHCpSyBOOEwioYNTx2JrKiq06k6rwfBscFiMNOGY1JYXDZrg83jhfq1GLnicDh+I8LQdSum61WSo8R14Sq1ZVKs4YXDQnOUKdKND/9k=); background-size: cover; }\n' +
			'img[src*="images/secrets-of-the-phoenix-tile-10-300.png"] { background-image: url(data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAcAEAMBEQACEQEDEQH/xAGiAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgsQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+gEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoLEQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2gAMAwEAAhEDEQA/ANL4I+Mb3VfEfinTPCEOtWvwx8G+HNO1/wAI+G9WuxdPpfhvxNZ6TbWmg/ar7X9VuNPtNC17wx4x1Dw1YWqamkWl+J1i1e+l1G9mfQfis98cocNeB/CNbLMdm3Djx+cc08dluEj9dU8v4izTD46mlh8ypSnHNaeeUsNXnUxKVSeBwtfEUnHC0ovXiHwJyTiTiLJOBsDgcgxvEWDw+Pw2Y4nH4WdTCTx2IlXx2RQrYjGYepKFKvRzHCxx2LwuFxk8NTwkYYXC0nTlTxfrt78SPEhvPiL4Zv8AT4ovCVt8Ivit498QWsE0M13418PeG7/wIbPw3caNqZ1nw3pd/ptvqQ1CS/Md2ttaT3h0u4vtektzY/JZ/wCJ2N4k4czHOMFnGfVMs/stfUMHjMwxuKxFfMq+YUcBVxuKq5lWxbwUsFUyzFVsCsDVcZ4ati6KjgqldOv+f+Gng5Xp8fZNHFYbh/A0MjzbNclzStl+DoYermVLl+v0cM8JgsNQofVnRnHAyq1K9WrWqxWMr0oOjh4U/wD/2Q==); background-size: cover; }'
		);
	});
});
